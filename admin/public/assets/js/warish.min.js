var warish_table, from_date, to_date, warish_certi_table, url = $("meta[name = path]").attr("content"),
    csrf = $("mata[name = csrf-token]").attr("content");

function warish_applicant_list() {
    from_date = $("#from_date").val(), to_date = $("#to_date").val(), warish_table = $("#warish_applicant_table").DataTable({
        scrollCollapse: !0,
        autoWidth: !1,
        responsive: !0,
        serverSide: !0,
        processing: !0,
        ajax: {
            dataType: "JSON",
            type: "post",
            url: warish_applicant_data_url,
            data: {
                from_date: from_date,
                to_date: to_date,
                _token: warish_applicant_csrf
            }
        },
        columns: [{
            data: null,
            render: function () {
                return warish_table.page.info().start + warish_table.column(0).nodes().length
            }
        }, {
            data: null,
            render: function (a, t, e) {
                return "<a class='link_color' href='edit/" + a.tracking + "'>" + a.name_bn + "</a>"
            }
        }, {
            data: "father_name_bn"
        }, {
            data: "tracking"
        }, {
            data: "pin"
        }, {
            data: null,
            render: function (a) {
                return null == a.mobile ? "---" : a.mobile
            }
        }, {
            data: "created_time"
        }, {
            data: null,
            render: function (a, t, e, n) {
                var r = "",
                    i = "",
                    o = "";
                return $("#generate").val() && (o = "<a  href='javascript:void(0)' onclick='warish_generate(" + n.row + ")' ><p class='btn btn-sm btn-primary'>জেনারেট</p></a> "), $("#edit").val() && (r = "<a  href='edit/" + a.tracking + "'><p class='btn btn-sm btn-warning'>এডিট</p></a> "), $("#delete").val() && (i = "<a  href='javascript:void(0)'><p class='btn btn-sm btn-danger' onclick='warish_delete(" + a.application_id + ", " + a.tracking + ")' >ডিলিট</p></a> "), o + r + "<a  href='preview/" + a.tracking + "' target='_blank'><p class='btn btn-sm btn-success'>আবেদন প্র্রিন্ট</p></a> " + i
            }
        }],
        columnDefs: [{
            targets: "datatable-nosort",
            orderable: !1
        }],
        lengthMenu: [
            [10, 25, 50, -1],
            [10, 25, 50, "All"]
        ],
        language: {
            info: "_START_-_END_ of _TOTAL_ entries",
            searchPlaceholder: "Search"
        },
        dom: "Bfrtip",
        buttons: ["copy", "csv", "pdf", "print"]
    })
}

function applicant_list_search() {
    from_date = $("#from_date").val(), to_date = $("#to_date").val(), $("#warish_applicant_table").dataTable().fnSettings().ajax.data.from_date = from_date, $("#warish_applicant_table").dataTable().fnSettings().ajax.data.to_date = to_date, warish_table.ajax.reload()
}

function account_list() {
    $.ajaxSetup({
        headers: {
            "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content")
        }
    }), $.ajax({
        url: url + "/global/account_list",
        type: "POST",
        dataType: "JSON",
        data: {},
        success: function (a) {
            var t;
            "success" == a.status && (a.data.forEach((function (a) {
                28 == a.id ? t += '<option value ="' + a.id + '"> ভূমিহীন সনদ</option>' : t += '<option value ="' + a.id + '">' + a.account_name + "</option>"
            })), $("#account").html(t))
        }
    })
}

function warish_generate(a) {
    var t = warish_table.row(a).data();
    account_list(), $("#tracking").val(t.tracking), $("#pin").val(t.pin), $("#name").val(t.name_bn), $("#application_id").val(t.application_id), $("#union_id").val(t.union_id), $("#upazila_id").val(t.permanent_upazila_id), $("#district_id").val(t.permanent_district_id), $("#warish_generate_modal").modal("show")
}

function generate_save() {
    var a = $("#tracking").val(),
        t = $("#pin").val(),
        e = $("#application_id").val(),
        n = $("#account").val(),
        r = $("#fee").val(),
        i = $("#warish_generate_date").val(),
        o = $("#union_id").val(),
        l = $("#upazila_id").val(),
        s = $("#district_id").val(),
        _ = $("#investigator_name_bn").val(),
        c = $("#investigator_name_en").val(),
        d = document.getElementById("investigator_name_bn");
    "" == _ ? d.classList.add("error") : (d.classList.remove("error"), swal({
        title: "অনুমোদন",
        text: "আপনি কি সনদটি জেনারেট করতে চান ?",
        type: "warning",
        showConfirmButton: !0,
        confirmButtonClass: "btn-success",
        confirmButtonText: "হ্যাঁ",
        showCancelButton: !0,
        cancelButtonText: "না",
        showLoaderOnConfirm: !0,
        preConfirm: function () {
            $.ajax({
                url: warish_generate_url,
                type: "POST",
                dataType: "JSON",
                data: {
                    tracking: a,
                    pin: t,
                    union_id: o,
                    credit_id: n,
                    fee: r,
                    generate_date: i,
                    upazila_id: l,
                    district_id: s,
                    application_id: e,
                    investigator_name_bn: _,
                    investigator_name_en: c,
                    _token: warish_generate_csrf
                },
                success: function (a) {
                    $("#warish_generate_modal").modal("hide"), swal({
                        title: "ধন্যবাদ",
                        text: a.message,
                        type: a.status,
                        showCancelButton: !0,
                        cancelButtonText: "বাতিল",
                        showConfirmButton: !0,
                        confirmButtonText: '<a href="' + warish_bangla_sonod_url + "/" + a.sonod_no + '" target="_blank">প্রিন্ট</a>',
                        closeOnConfirm: !0,
                        allowEscapeKey: !1
                    }), warish_table.ajax.reload()
                }
            })
        }
    }).then((function () {})))
}

function warish_delete(a, t) {
    swal({
        title: "অনুমোদন",
        text: "আপনি কি আবেদনটি ডিলিট করতে চান ?",
        type: "warning",
        showConfirmButton: !0,
        confirmButtonClass: "btn-success",
        confirmButtonText: "হ্যাঁ",
        showCancelButton: !0,
        cancelButtonText: "না",
        showLoaderOnConfirm: !0,
        preConfirm: function () {
            $.ajax({
                url: warish_delete_url,
                type: "POST",
                dataType: "JSON",
                data: {
                    appId: a,
                    tracking: t,
                    _token: warish_delete_csrf
                },
                success: function (a) {
                    swal({
                        title: "মোছা হয়েছে!",
                        text: a.message,
                        type: a.status,
                        showCancelButton: !1,
                        showConfirmButton: !0,
                        confirmButtonText: "ঠিক আছে",
                        closeOnConfirm: !0,
                        allowEscapeKey: !1
                    }), warish_table.ajax.reload()
                }
            })
        }
    })
}

function warish_certificate_list() {
    from_date = $("#from_date").val(), to_date = $("#to_date").val(), warish_certi_table = $("#warish_certificate_table").DataTable({
        scrollCollapse: !0,
        autoWidth: !1,
        responsive: !0,
        serverSide: !0,
        processing: !0,
        ajax: {
            dataType: "JSON",
            type: "post",
            url: warish_certificate_data_url,
            data: {
                from_date: from_date,
                to_date: to_date,
                _token: warish_certificate_csrf
            }
        },
        columns: [{
            data: null,
            render: function () {
                return warish_certi_table.page.info().start + warish_certi_table.column(0).nodes().length
            }
        }, {
            data: null,
            render: function (a, t, e) {
                return "<a class='link_color' href='edit/" + a.tracking + "/" + a.sonod_no + "'>" + a.name_bn + "</a>"
            }
        }, {
            data: "father_name_bn"
        }, {
            data: "tracking"
        }, {
            data: "pin"
        }, {
            data: "sonod_no"
        }, {
            data: "member_count"
        }, {
            data: null,
            render: function (a) {
                return null == a.mobile ? "---" : a.mobile
            }
        }, {
            data: "generate_date"
        }, {
            data: null,
            render: function (a, t, e, n) {
                var r = "",
                    i = "",
                    o = "";
                return $("#regenerate").val() && (i = "<a  href='javascript:void(0)' onclick='warish_regenerate(" + n.row + ")' ><p class='btn btn-sm btn-primary custom_button'>রি-জেনারেট</p></a> "), $("#edit").val() && (r = "<a  href='edit/" + a.tracking + "/" + a.sonod_no + "'><p class='btn btn-sm btn-warning' >এডিট</p></a> "), $("#invoice").val() && (o = "<a  href='money_receipt/" + a.sonod_no + "' target='_blank'><p class='btn btn-sm custom_button_violet'>রশিদ</p></a>"), "<a  href='print_bn/" + a.sonod_no + "' target='_blank' ><p class='btn btn-sm btn-primary '>বাংলা</p></a>  <a  href='print_en/" + a.sonod_no + "' target='_blank' ><p class='btn btn-sm btn-success'>ইংরেজি</p></a> " + r + i + o
            }
        }],
        columnDefs: [{
            targets: "datatable-nosort",
            orderable: !1
        }],
        lengthMenu: [
            [10, 25, 50, -1],
            [10, 25, 50, "All"]
        ],
        language: {
            info: "_START_-_END_ of _TOTAL_ entries",
            searchPlaceholder: "Search"
        },
        dom: "Bfrtip",
        buttons: ["copy", "csv", "pdf", "print"]
    })
}

function certificate_list_search() {
    from_date = $("#from_date").val(), to_date = $("#to_date").val(), $("#warish_certificate_table").dataTable().fnSettings().ajax.data.from_date = from_date, $("#warish_certificate_table").dataTable().fnSettings().ajax.data.to_date = to_date, warish_certi_table.ajax.reload()
}

function warish_regenerate(a) {
    var t = warish_certi_table.row(a).data();
    account_list(), $("#sonod_no").val(t.sonod_no), $("#tracking").val(t.tracking), $("#pin").val(t.pin), $("#name").val(t.name_bn), $("#application_id").val(t.application_id), $("#union_id").val(t.union_id), $("#upazila_id").val(t.permanent_upazila_id), $("#district_id").val(t.permanent_district_id), $("#warish_regenerate_modal").modal("show")
}

function regenerate_save() {
    var a = $("#tracking").val(),
        t = $("#sonod_no").val(),
        e = $("#pin").val(),
        n = $("#application_id").val(),
        r = $("#account").val(),
        i = $("#fee").val(),
        o = $("#warish_generate_date").val(),
        l = $("#union_id").val(),
        s = $("#upazila_id").val(),
        _ = $("#district_id").val();
    swal({
        title: "অনুমোদন",
        text: "আপনি কি সনদটি রি-জেনারেট করতে চান ?",
        type: "warning",
        showConfirmButton: !0,
        confirmButtonClass: "btn-success",
        confirmButtonText: "হ্যাঁ",
        showCancelButton: !0,
        cancelButtonText: "না",
        showLoaderOnConfirm: !0,
        preConfirm: function () {
            $.ajax({
                url: warish_regenerate_url,
                type: "POST",
                dataType: "JSON",
                data: {
                    tracking: a,
                    sonod_no: t,
                    pin: e,
                    credit_id: r,
                    fee: i,
                    generate_date: o,
                    union_id: l,
                    upazila_id: s,
                    district_id: _,
                    application_id: n,
                    _token: warish_regenerate_csrf
                },
                success: function (a) {
                    $("#warish_regenerate_modal").modal("hide"), swal({
                        title: "ধন্যবাদ",
                        text: a.message,
                        type: a.status,
                        showCancelButton: !0,
                        cancelButtonText: "বাতিল",
                        showConfirmButton: !0,
                        confirmButtonText: '<a href="' + warish_bangla_sonod_url + "/" + a.sonod_no + '" target="_blank">প্রিন্ট</a>',
                        closeOnConfirm: !0,
                        allowEscapeKey: !1
                    }), warish_certi_table.ajax.reload()
                }
            })
        }
    }).then((function () {}))
}
setTimeout((function () {
    $(".alert-success").hide("slow")
}), 3e3), $("#warish_generate_date, #from_date, #to_date").datepicker({
    language: "en",
    autoClose: !0,
    dateFormat: "yyyy-mm-dd"
});
