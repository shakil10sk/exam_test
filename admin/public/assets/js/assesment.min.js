var assesment_table,fiscal_year_id,ward_no,holding_no,url=$("meta[name = path]").attr("content"),csrf=$("mata[name = csrf-token]").attr("content");function assesment_list(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),assesment_table=$("#assesment_list_table").DataTable({scrollCollapse:!0,autoWidth:!1,responsive:!0,serverSide:!0,processing:!0,ajax:{dataType:"JSON",type:"post",url:url+"/accounts/assesment_list_data",data:{fiscal_year_id:fiscal_year_id,ward_no:ward_no,holding_no:holding_no}},columns:[{data:null,render:function(){return assesment_table.page.info().start+assesment_table.column(0).nodes().length}},{data:"name"},{data:"pin"},{data:"holding_no"},{data:"ward_no"},{data:"halson_tax"},{data:null,render:function(a,e,t){return 1==a.is_paid?'<span class="badge badge-primary">Paid</span>':'<span class="badge badge-danger">Unpaid</span>'}},{data:null,render:function(a,e,t,n){let s="",o="",r="",l="";return $("#add-home-tax").val()&&1!=a.is_paid&&(s="<a  href='javascript:void(0)' onclick='home_tax_collect("+n.row+")'><p class='btn btn-sm btn-info' >কর আদায়</p></a> "),$("#edit-home").val()&&(o="<a  href='"+url+"/accounts/assesment_edit/"+a.pin+"'><p class='btn btn-sm btn-warning'>এডিট</p></a> "),$("#home-tax-invoice").val()&&(r="<a  href='"+url+"/accounts/home_tax_money_receipt/"+a.pin+"' target='_blank'><p class='btn btn-sm custom_button_violet'>রশিদ</p></a> "),$("#delete-home").val()&&(l="<a  href='javascript:void(0)'><p class='btn btn-sm btn-danger' >ডিলিট</p></a> "),1!=a.is_paid&&(r=""),s+o+r+l}}],columnDefs:[{targets:"datatable-nosort",orderable:!1}],lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],language:{info:"_START_-_END_ of _TOTAL_ entries",searchPlaceholder:"Search"},dom:"Bfrtip",buttons:["copy","csv","pdf","print"]})}function assesment_list_search(){fiscal_year_id=$("#fiscal_year_id").val(),ward_no=$("#ward_no").val(),holding_no=$("#holding_no").val(),$("#assesment_list_table").dataTable().fnSettings().ajax.data.fiscal_year_id=fiscal_year_id,$("#assesment_list_table").dataTable().fnSettings().ajax.data.ward_no=ward_no,$("#assesment_list_table").dataTable().fnSettings().ajax.data.holding_no=holding_no,assesment_table.ajax.reload()}function home_tax_collect(a){$("#discount").val(0);var e=assesment_table.row(a).data();$("#pin").val(e.pin),$("#name").val(e.name),$("#halson_tax").val(e.halson_tax);var t=0;e.due_tax>0&&(t=parseInt(e.due_tax)),$("#due_tax").val(t),$("#kor").val(parseInt(t)+parseInt(e.halson_tax)),$("#house_tax_collection_modal").modal("show")}function discount_calculation(){var a=$("#halson_tax").val(),e=$("#due_tax").val(),t=$("#discount").val();""==t&&(t=0),e<0&&(e=0),$("#kor").val(parseInt(e)+parseInt(a)-parseInt(t))}function house_tax_save(){var a=$("#pin").val(),e=$("#halson_tax").val(),t=$("#due_tax").val(),n=$("#discount").val(),s=$("#kor").val(),o=$("#generate_date").val();n<0&&(n=0),t<0&&(t=0),swal({title:"অনুমোদন",text:"আপনি কি "+s+" টাকা কর আদায় করতে চান ?",type:"warning",showConfirmButton:!0,confirmButtonClass:"btn-success",confirmButtonText:"হ্যাঁ",showCancelButton:!0,cancelButtonText:"না",showLoaderOnConfirm:!0,preConfirm:function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({url:url+"/accounts/home_tax_save",type:"POST",dataType:"JSON",data:{pin:a,halson_tax:e,due_tax:t,discount:n,kor:s,generate_date:o},success:function(a){$("#house_tax_collection_modal").modal("hide"),swal({title:"ধন্যবাদ",text:a.message,type:a.status,showCancelButton:!0,cancelButtonText:"বাতিল",showConfirmButton:!0,confirmButtonText:'<a href="home_tax_money_receipt/'+a.pin+'" target="_blank">রশিদ</a>',closeOnConfirm:!0,allowEscapeKey:!1}),assesment_table.ajax.reload()}})}}).then((function(){}))}function check_assesment_exist_data(){var a=$("#search_data").val();$.ajax({type:"POST",dataType:"JSON",url:url+"/accounts/check_assesment",beforeSend:function(){$(".pre-loader").fadeToggle("medium")},complete:function(){$(".pre-loader").fadeOut()},data:{search_data:a},success:function(a){"error"==a.status?swal({type:"error",title:"দুঃখিত !",text:a.msg,confirmButtonText:"ঠিক আছে"}):"success"==a.status?swal({type:"success",title:"Success",text:a.msg,confirmButtonText:"ঠিক আছে"}):(1==a.gender&&2==a.marital_status?($("#wife").show(),$("#wife_name_bn").attr("required","required"),$("#husband").hide(),$("#husband_name_bn").removeAttr("required"),$("#husband_name_en").val(""),$("#husband_name_bn").val("")):2==a.gender&&2==a.marital_status&&($("#husband").show(),$("#husband_name_bn").attr("required","required"),$("#wife").hide(),$("#wife_name_bn").removeAttr("required"),$("#wife_name_en").val(""),$("#wife_name_bn").val("")),$.each(a,(function(a,e){$("#"+a).val(e),$("#"+a).prop("disabled",!0)})),$("#name_bn").val(a.name_bn),$("#nagorik-pin").val(a.pin),$("#father-name-bn").val(a.father_name_bn),$("#mother-name-bn").val(a.mother_name_bn),$("#gender_"+a.gender).attr("checked",!0),$(".gender").attr("disabled",!0),$(".wrap").css("opacity",".2"),$("#marital_status").val(a.marital_status),$("#sonaton").val(a.religion),$("#wife_name_bn").val(a.wife_name_bn),$("#husband_name_bn").val(a.husband_name_bn),$("#permanent_district_id").append('<option value="'+a.permanent_district_id+'" selected="selected">'+a.permanent_district_name_en+"</option>"),$("#permanent_district_id").prop("disabled",!0),$("#permanent_district").val(a.permanent_district_name_bn),$("#permanent_upazila_id").html('<option value="'+a.permanent_upazila_id+'" selected="selected">'+a.permanent_upazila_name_en+"</option>"),$("#permanent_upazila_id").prop("disabled",!0),$("#permanent_upazila").val(a.permanent_upazila_name_bn),$("#permanent_postoffice_id").html('<option value="'+a.permanent_postoffice_id+'" selected="selected">'+a.permanent_postoffice_name_en+"</option>"),$("#permanent_postoffice_id").prop("disabled",!0),$("#permanent_postoffice").val(a.permanent_postoffice_name_bn))}})}$("#from_date, #to_date, #generate_date").datepicker({language:"en",autoClose:!0,dateFormat:"yyyy-mm-dd"});